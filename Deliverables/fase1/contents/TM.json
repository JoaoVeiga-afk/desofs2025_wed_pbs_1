{
  "version": "2.4.1",
  "summary": {
    "title": "ShopTex",
    "owner": "João Veiga",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "1211106@isep.ipp.pt"
      }
    ],
    "diagrams": [
      {
        "id": 0,
        "title": "Threat Model",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Response (HTTP/S)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": []
            },
            "labels": [
              "Web Response (HTTP/S)"
            ],
            "id": "90300e48-1991-4c71-9ce6-23f22cd242ba",
            "source": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "target": {
              "x": 150,
              "y": 70
            },
            "vertices": [
              {
                "x": 170,
                "y": 200
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Request (HTTP/S)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": []
            },
            "labels": [
              "Web Request (HTTP/S)"
            ],
            "id": "f9ba42af-1a37-41c0-82cb-e18f25cc4c4b",
            "source": {
              "cell": "2552657f-eff4-4149-b850-e8f1c154216c"
            },
            "target": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "vertices": [
              {
                "x": 310,
                "y": 130
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Queries (MySQL\nwire protocol)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "MySQL wire protocol over TLS",
              "threats": []
            },
            "labels": [
              "Queries (MySQL\nwire protocol)"
            ],
            "id": "b4e5d5d0-f9cd-4a3e-8788-5a26f5b444c8",
            "source": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "target": {
              "cell": "f310165b-1213-417a-9fc7-897c82689664"
            },
            "vertices": [
              {
                "x": 370,
                "y": 420
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web App Query Results \n(MySQL wire protocol)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "MySQL wire protocol over TLS",
              "threats": []
            },
            "labels": [
              "Web App Query Results \n(MySQL wire protocol)"
            ],
            "id": "4c6858f5-996c-4581-a58d-30022a995fc5",
            "source": {
              "cell": "f310165b-1213-417a-9fc7-897c82689664"
            },
            "target": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "vertices": [
              {
                "x": 480,
                "y": 360
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Read Files (SFTP)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "SFTP",
              "threats": []
            },
            "labels": [
              "Read Files (SFTP)"
            ],
            "id": "ffca23a9-4fb2-4065-9af5-d226e4048b68",
            "source": {
              "cell": "98b9a69c-44df-4e56-b270-b759c948efa3"
            },
            "target": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "vertices": [
              {
                "x": 220,
                "y": 440
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Trust Boundary"
                  }
                }
              }
            ],
            "id": "dd6c38ed-854b-48cf-8449-8564593d5dee",
            "source": {
              "x": 30,
              "y": 80
            },
            "target": {
              "x": 410,
              "y": 60
            },
            "vertices": [
              {
                "x": 250,
                "y": 160
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Trust Boundary"
                  }
                }
              }
            ],
            "id": "adf3710d-3835-46d6-98e1-4ff5a1742740",
            "source": {
              "x": 330,
              "y": 610
            },
            "target": {
              "x": 670,
              "y": 570
            },
            "vertices": [
              {
                "x": 390,
                "y": 530
              },
              {
                "x": 510,
                "y": 440
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web App Write Log (Syslog)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Syslog over TLS",
              "threats": []
            },
            "labels": [
              "Web App Write Log (Syslog)"
            ],
            "id": "11371dd2-0528-46fc-99f7-f808402d052b",
            "source": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "target": {
              "cell": "27310524-54c2-49bc-961a-e38346b686ee",
              "port": "4f528ab5-5ec4-4ce7-9831-115d6dae3bad"
            },
            "vertices": [
              {
                "x": 510,
                "y": 285
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web App Read Log (Syslog)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "Syslog over TLS",
              "threats": []
            },
            "labels": [
              "Web App Read Log (Syslog)"
            ],
            "id": "b2be1b07-8209-4c09-b5bc-84c30ab69e18",
            "source": {
              "cell": "27310524-54c2-49bc-961a-e38346b686ee",
              "port": "4f528ab5-5ec4-4ce7-9831-115d6dae3bad"
            },
            "target": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5",
              "port": "815a2a99-d697-47d9-8b52-a11dde81c1ff"
            },
            "vertices": [
              {
                "x": 470,
                "y": 220
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Trust Boundary"
            ],
            "id": "764fa6d4-52af-42be-90a9-3347d2e08d0d",
            "source": {
              "x": 580,
              "y": 140
            },
            "target": {
              "x": 810,
              "y": 230
            },
            "vertices": [
              {
                "x": 590,
                "y": 260
              },
              {
                "x": 670,
                "y": 280
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Write Files (SFTP)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "SFTP",
              "threats": []
            },
            "labels": [
              "Write Files (SFTP)"
            ],
            "id": "423710de-d027-4f8e-8bca-7a043fa56589",
            "source": {
              "cell": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5"
            },
            "target": {
              "cell": "98b9a69c-44df-4e56-b270-b759c948efa3"
            },
            "vertices": [
              {
                "x": 190,
                "y": 340
              },
              {
                "x": 130,
                "y": 420
              }
            ]
          },
          {
            "position": {
              "x": 230,
              "y": 240
            },
            "size": {
              "width": 90,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Web \nApplication"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "d460c722-9cd5-402b-9b0c-feda9b47f55f"
                },
                {
                  "group": "right",
                  "id": "815a2a99-d697-47d9-8b52-a11dde81c1ff"
                },
                {
                  "group": "bottom",
                  "id": "50194f46-c8cb-42cd-a784-4a5b3dfbaf32"
                },
                {
                  "group": "left",
                  "id": "8ace800e-6bd8-4502-8464-7758e94f32e0"
                }
              ]
            },
            "id": "8c14c06b-8618-4c2f-a30e-dd1fa0c09cb5",
            "data": {
              "type": "tm.Process",
              "name": "Web \nApplication",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "732547b1-f701-4ff5-8554-d6870d13fa2b",
                  "title": "Code Injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attackers inject malicious code into input fields or URLs",
                  "mitigation": "Input validation / escaping; WAF; SAST/DAST",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": "4"
                },
                {
                  "id": "38ba39d0-f45f-4191-b3d4-6c7d197cb0b6",
                  "title": "Remote Code Execution (RCE)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Exploiting vulnerabilities that let attackers run arbitrary code on your server.",
                  "mitigation": "Rapid patching; container isolation; SAST",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": "5"
                },
                {
                  "id": "17dcc307-941b-4f10-870a-fa7023ea9585",
                  "title": "DDoS",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Botnets exhaust bandwidth/resources.",
                  "mitigation": "CDN/Anycast; auto‑scaling; rate‑limiting",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": "4"
                },
                {
                  "id": "501b2e3d-060f-4841-ad20-8ab128f316a4",
                  "title": "DoS",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Single‑source resource exhaustion (e.g., slow‑loris).",
                  "mitigation": "Short timeouts; connection limits",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": "3"
                },
                {
                  "id": "1b995216-02bb-42eb-a3f0-fa4f77b88013",
                  "title": "Broken Authentication",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Poor session management or credential flaws.",
                  "mitigation": "MFA; strong hashing (bcrypt); token rotation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": "4"
                },
                {
                  "id": "5b8f8380-fff2-448f-85fc-0b3fb9d94744",
                  "title": "Directory Traversal",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Using ../ in URLs to access restricted files.",
                  "mitigation": "Path normalization; whitelists; chroot/jail",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": "3"
                },
                {
                  "id": "a7de9264-4407-4af3-87ba-a3c3f83576eb",
                  "title": "Server-Side Request Forgery (SSRF)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Exploiting a web server's ability to make HTTP requests on behalf of the attacker.",
                  "mitigation": "Destination allow‑list; block metadata IPs; WAF",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": "4"
                },
                {
                  "id": "807281f3-26ca-4e4e-b3f8-2ec035b4be99",
                  "title": "Cross-Site Scripting (XSS)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Injecting malicious scripts into web pages served to users.",
                  "mitigation": "Output encoding; CSP; input sanitization",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": "4"
                },
                {
                  "id": "dbbd14b0-c183-46a7-aca2-3007db37a557",
                  "title": "Misconfigured Security Headers",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Missing or misconfigured HTTP response headers.",
                  "mitigation": "Set headers like Content-Security-Policy, X-Frame-Options, X-XSS-Protection.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": "2"
                },
                {
                  "id": "bfa156b8-0953-4a9c-a8de-ee5d1da66a26",
                  "title": "Information Leakage",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Server discloses sensitive info (e.g., stack traces, headers, debug messages).",
                  "mitigation": "Disable debug in prod; sanitize error output",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": "3"
                },
                {
                  "id": "fc8e9dbf-31a7-4181-8ec4-de82ebbce157",
                  "title": "Open Redirects",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Web server accepts unvalidated redirects.",
                  "mitigation": "Allow‑list destinations; state tokens",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": "3"
                },
                {
                  "id": "f0c73910-5aa3-4df0-ba54-681b33b1eeca",
                  "title": "Cross-Site Request Forgery (CSRF)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": " Trick users into submitting unwanted requests to your server while they’re logged in.",
                  "mitigation": "CSRF tokens; SameSite cookies; origin check",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": "3"
                },
                {
                  "id": "0e858212-03b6-4274-b06e-f8bd6439c56e",
                  "title": "Broken Access Control / IDOR",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Endpoints allow unauthorized access or modification of resources (Insecure Direct Object Reference).",
                  "mitigation": "Enforce server‑side authorization checks; least‑privilege APIs; rigorous test cases",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": "5"
                },
                {
                  "id": "0866cf01-9266-40e2-9b57-9e7340df6393",
                  "title": "Insecure Deserialization",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Untrusted data is deserialized leading to RCE, data tampering or DOS.",
                  "mitigation": "Avoid native serialization of untrusted data; integrity signatures; deserialization firewalls",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": "4"
                },
                {
                  "id": "93a84ed4-0e50-4553-b42c-4bf183d54cb2",
                  "title": "XML External Entity (XXE)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "XML parsers process external entities allowing file read, SSRF or DOS.",
                  "mitigation": "Disable DTDs/external entities; switch to safe parsers; WAF regex filters",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": "4"
                },
                {
                  "id": "1d83fb6a-1cd7-47f4-9f03-26cfe4c6787d",
                  "title": "Server‑Side Template Injection (SSTI)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "User input injected into template engine expressions leading to code execution.",
                  "mitigation": "Strict template delimiters; sandbox templates; input validation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": "4"
                },
                {
                  "id": "e39d6633-bc0a-4b06-b92c-b74eea253d5f",
                  "title": "Mass Assignment",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Automatic binding of HTTP parameters to object fields lets attacker overwrite sensitive properties.",
                  "mitigation": "Allow list bindable fields; DTOs; security-focused frameworks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": "3"
                },
                {
                  "id": "0215ab6b-4d84-46cf-82a7-96a11efda9a7",
                  "title": "Business Logic Abuse",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Legitimate features mis‑used in unexpected order/volume to subvert business rules.",
                  "mitigation": "Threat modeling; usage rate‑limits; server‑side invariant checks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": "4"
                },
                {
                  "id": "4aa2826c-3604-4588-a660-043e003e527e",
                  "title": "Insecure Randomness",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Predictable tokens, IDs or OTPs allow guessing and takeover.",
                  "mitigation": "Use cryptographically secure PRNGs; sufficient entropy; periodic rotation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": "3"
                },
                {
                  "id": "d7baca1c-c391-424c-be90-b54eaa1c30d4",
                  "title": "HTTP Request Smuggling (Back‑end)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Front/back proxy parsing mismatch enabling cache poisoning or credential bypass.",
                  "mitigation": "Consistent parser versions; disable conflicting encodings; detailed logging",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": "3"
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "tampering": 6,
                "repudiation": 2,
                "informationDisclosure": 5,
                "denialOfService": 3,
                "elevationOfPrivilege": 4
              }
            }
          },
          {
            "position": {
              "x": 50,
              "y": 540
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "File System"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "38b97aaf-58a1-43b9-9e61-e36fbc482cc4"
                },
                {
                  "group": "right",
                  "id": "bdda7381-a4b5-4244-af8b-01e494e90e62"
                },
                {
                  "group": "bottom",
                  "id": "95ffbfa9-23b6-4b51-b6b1-0a05f9389c40"
                },
                {
                  "group": "left",
                  "id": "4f528ab5-5ec4-4ce7-9831-115d6dae3bad"
                }
              ]
            },
            "id": "98b9a69c-44df-4e56-b270-b759c948efa3",
            "data": {
              "type": "tm.Store",
              "name": "File System",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "ce3fabf6-6dff-4127-9a46-f8966e6cf68e",
                  "title": "Web Shell Uploads",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Attackers upload malicious files (like PHP, JSP, or Python scripts) that give remote shell access via the browser.",
                  "mitigation": "- Strict file validation (type, size, extension).\n- Block script execution in upload directories via .htaccess, Nginx rules, etc\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 56,
                  "score": "4"
                },
                {
                  "id": "e845b81c-647f-4cbf-bd33-d22bd85c424d",
                  "title": "Directory Traversal",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Attackers manipulate paths like ../../etc/passwd to access sensitive files.",
                  "mitigation": "\"- Normalize paths, whitelist directories, never rely on user input for file paths.\n- Disable directory listings in web server config.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 57,
                  "score": "3"
                },
                {
                  "id": "7db90696-684b-46ef-be28-ee873dad4593",
                  "title": "Unauthorized File Downloads",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Improper access controls allow direct file downloads (e.g., logs, configs, private PDFs).",
                  "mitigation": "- Enforce access controls on all files.\n- Move sensitive files outside the web root.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 58,
                  "score": "3"
                },
                {
                  "id": "889c0931-fa6c-4789-b661-e38ada81def1",
                  "title": "Insecure Permissions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Files or folders have overly permissive access (chmod 777, or owner is www-data for everything).",
                  "mitigation": "- Use chown, chmod, and group ownership properly.\n- Enforce least privilege for web server users\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 59,
                  "score": "3"
                },
                {
                  "id": "fd56eb01-e9da-45b4-895e-dd4df114f2b9",
                  "title": "Symbolic Link Abuse",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Malicious symlinks point from a web-accessible folder to sensitive areas (like /etc/ or /home/).",
                  "mitigation": "- Scan for unexpected symlinks.\n- Use chroot or container isolation.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 60,
                  "score": "3"
                },
                {
                  "id": "cb1e5514-254a-49b6-bddc-8f23259a81af",
                  "title": "Exposed Backup Files",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Developers leave .bak, .zip, .tar, .sql, or .old files in the web root.",
                  "mitigation": "- Never store backup or development artifacts in web-accessible folders.\n- Automate cleanup with scripts or CI/CD checks.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 61,
                  "score": "3"
                },
                {
                  "id": "435748bc-4c25-4252-ad20-529070331ed2",
                  "title": "Tampered Static Assets",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "JavaScript, CSS, or images modified to inject malware or tracking (supply chain attacks).",
                  "mitigation": "- Use Subresource Integrity (SRI).\n- Monitor file hashes for changes (integrity scanning).\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 62,
                  "score": "3"
                },
                {
                  "id": "8154d846-af2f-4e6c-8a86-b76a250a0cd0",
                  "title": "Log Injection / Poisoning",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Attacker injects malicious data into logs (e.g., via headers, user agents).",
                  "mitigation": "- Sanitize all user-controlled log inputs.\n- Store logs in write-only or append-only formats.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 63,
                  "score": "2"
                },
                {
                  "id": "5ba37c10-5f03-4e9c-82f3-563dba0cc3e2",
                  "title": "Insecure File Inclusion (LFI/RFI)",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "Web apps dynamically include files using user input (e.g., include($_GET['page'])).",
                  "mitigation": "Sanitize/validate all paths before inclusion.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 64,
                  "score": "4"
                },
                {
                  "id": "f04d2e59-df7c-4641-825c-01cb0b9bb995",
                  "title": "Sensitive Config Files in Web Root",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Files like .env, config.php, wp-config.php, or .htaccess are exposed.",
                  "mitigation": "- Move configs outside web root.\n- Deny access via web server rules (e.g., location ~ /\\.(env|htaccess)$ in Nginx).\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 65,
                  "score": "4"
                },
                {
                  "id": "04e5c151-fad1-45c3-92a7-0e58e095890d",
                  "title": "Ransomware Encryption",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Malware encrypts application data and demands ransom.",
                  "mitigation": "Offline backups; SELinux/AppArmor; real‑time AV; incident playbooks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 66,
                  "score": "5"
                },
                {
                  "id": "08f2aafa-ac52-4634-8d95-a816ae394c2d",
                  "title": "World‑Readable Temp Files",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Temporary files created with insecure permissions leak sensitive data.",
                  "mitigation": "umask hardening; secure tmp dirs; periodic scans",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 67,
                  "score": "3"
                },
                {
                  "id": "1124584a-cdbd-4975-bf54-950e838575ab",
                  "title": "Hard Link Abuse",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Attackers create hard links to sensitive files to bypass ACL changes.",
                  "mitigation": "fs.protected_hardlinks; disallow links in upload dirs; integrity scans",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 68,
                  "score": "3"
                },
                {
                  "id": "b1bbb7fb-df69-4e3d-ae50-d1ac570a01d4",
                  "title": "Residual Data in Deleted Files",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Deleted files remain recoverable on disk snapshots or backups.",
                  "mitigation": "Secure wipe; encrypted filesystems; snapshot lifecycle management",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 69,
                  "score": "2"
                },
                {
                  "id": "5b739d9c-7bf0-495d-98d9-20b576e21ca7",
                  "title": "Credential Leakage via OS Crash Dumps",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Core dumps containing secrets stored in accessible locations.",
                  "mitigation": "Disable core dumps or restrict path; scrub sensitive data; limit ulimit -c",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 70,
                  "score": "3"
                },
                {
                  "id": "8d24f0d8-3893-4b6f-a052-d6490b248e5e",
                  "title": "Insecure File Metadata Exposure",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "File metadata (EXIF, document properties) leaks sensitive info to users.",
                  "mitigation": "Strip metadata on upload; content scanning; user education",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 71,
                  "score": "2"
                },
                {
                  "id": "eae2a6f0-adb2-4959-b798-c4e5f22be2af",
                  "title": "Mounting External Volumes Insecurely",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": " External drives or mounted folders are readable/writable by the web server without proper security.",
                  "mitigation": "- Mount with noexec, nosuid, nodev where applicable.\n- Use access control lists (ACLs) to restrict users.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 72,
                  "score": "3"
                }
              ],
              "threatFrequency": {
                "tampering": 7,
                "repudiation": 2,
                "informationDisclosure": 8,
                "denialOfService": 1
              }
            }
          },
          {
            "position": {
              "x": 460,
              "y": 540
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "MySQL\nDatabase"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4a260899-01a3-4f03-b3d8-0f21b42ef948"
                },
                {
                  "group": "right",
                  "id": "0280ecf5-bd18-4ba4-9087-cf299d262d6d"
                },
                {
                  "group": "bottom",
                  "id": "74531c65-3c53-4c7d-b1d0-2d0cce9ba98f"
                },
                {
                  "group": "left",
                  "id": "ae7070ce-b51d-4a34-af19-eb083aaf47b3"
                }
              ]
            },
            "id": "f310165b-1213-417a-9fc7-897c82689664",
            "data": {
              "type": "tm.Store",
              "name": "MySQL\nDatabase",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "fcaa37f9-1ff9-470d-aa42-f5affe27ffc0",
                  "title": "SQL Injection (SQLi)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": " Unsanitized input is used to inject malicious SQL queries.",
                  "mitigation": "Prepared statements; ORM; WAF",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 37,
                  "score": "5"
                },
                {
                  "id": "7a134391-4f60-4da6-a116-8fde17ab3d48",
                  "title": "File Upload Vulnerabilities",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Web apps allow file uploads but fail to properly validate the files.",
                  "mitigation": "Strict MIME/extension checks; disable execution",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 38,
                  "score": "4"
                },
                {
                  "id": "03cd9dd7-88dc-4385-8795-9f8f485da155",
                  "title": "Weak or Default Credentials",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Using usernames like root with weak passwords (or none at all).",
                  "mitigation": "Enforce strong passwords, disable remote root login, and use least privilege.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 39,
                  "score": "4"
                },
                {
                  "id": "9c2bb581-3fa6-46d0-8d22-0cc820ae8263",
                  "title": "Exposed MySQL Port (3306)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "MySQL server is publicly accessible.",
                  "mitigation": "\"- Bind MySQL to localhost (or use a private network).\n- Use a firewall to restrict access to trusted IPs.\"",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 40,
                  "score": "3"
                },
                {
                  "id": "edf8f058-9d0a-430d-993d-039f5d6d352a",
                  "title": "Privilege Escalation",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": " Overprivileged accounts can modify or execute harmful queries.",
                  "mitigation": " Apply principle of least privilege for all accounts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 41,
                  "score": "4"
                },
                {
                  "id": "a39d5022-31ad-4937-99c6-87d91e967dac",
                  "title": "Data Exfiltration via SELECT / INTO OUTFILE",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": " If attackers gain access, they can dump data to a file and retrieve it.",
                  "mitigation": "Disable INTO OUTFILE and restrict write permissions to MySQL user.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 42,
                  "score": "4"
                },
                {
                  "id": "62877572-7158-44be-8fcc-5a0e412a5571",
                  "title": "Unencrypted Connections (No TLS)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Data, including credentials, flows in cleartext over the network.",
                  "mitigation": "Enable SSL/TLS for MySQL connections.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 43,
                  "score": "3"
                },
                {
                  "id": "bb5dff94-ff40-4d86-a079-495d5a5f6fe5",
                  "title": "Local File Inclusion via LOAD DATA INFILE",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "If not disabled, attackers can use this command to read sensitive files.",
                  "mitigation": "Disable LOAD DATA LOCAL INFILE unless absolutely required.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 44,
                  "score": "4"
                },
                {
                  "id": "8be5829a-1b9c-4409-ae59-5af76eb8b5fd",
                  "title": "Unpatched Vulnerabilities",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Running outdated versions of MySQL can expose you to known exploits.",
                  "mitigation": "Regularly patch and monitor security advisories.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 45,
                  "score": "4"
                },
                {
                  "id": "f31c4d01-78f0-4b04-903f-47364b30e845",
                  "title": "Information Disclosure via Errors",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "MySQL error messages reveal schema names, structure, or even partial queries.",
                  "mitigation": "Sanitize errors before sending them to clients; disable verbose errors in production.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 46,
                  "score": "3"
                },
                {
                  "id": "7fcb8aa8-6f33-49f0-bbd6-1b7dca428da6",
                  "title": "Backup Theft or Exposure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Backups stored insecurely (e.g., in /tmp, public S3 buckets).",
                  "mitigation": "Encrypt and store backups securely, and restrict access.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 47,
                  "score": "4"
                },
                {
                  "id": "9a99f66c-03ea-41db-8f51-fadc6b17ca99",
                  "title": "Denial of Service via Heavy Queries",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": " Resource-intensive queries lock tables or spike CPU/IO.",
                  "mitigation": " Rate-limit users, enforce query timeouts, and monitor for unusual activity.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 48,
                  "score": "3"
                },
                {
                  "id": "12aa9b02-3a5b-4a12-9a1f-1bedc11f335a",
                  "title": "Brute Force Attack on User Accounts",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Attackers try lots of passwords on known users (root, admin, etc.).",
                  "mitigation": "Use fail2ban or other login attempt monitoring tools.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 49,
                  "score": "3"
                },
                {
                  "id": "c9197bf3-7152-47b0-9af4-e20b5d30989e",
                  "title": "Unsafe Stored Procedures / Functions",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Procedures created with SQL SECURITY DEFINER run with elevated privileges and can be abused.",
                  "mitigation": "Review DEFINER privileges; limit CREATE ROUTINE; code review",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 50,
                  "score": "4"
                },
                {
                  "id": "5d14dd0f-678b-4f19-b5b8-a7e5d9dea122",
                  "title": "Binary Log Poisoning",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Malicious statements inserted into replication binlogs compromise replicas.",
                  "mitigation": "Encrypt/validate binlogs; restricted REPLICATE privilege; checksum enforcement",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 51,
                  "score": "4"
                },
                {
                  "id": "75e4d2ef-bbf7-46e9-9492-682822c72cf2",
                  "title": "Federated Table Abuse",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "FEDERATED engine queries remote servers, allowing SSRF or data leak if misconfigured.",
                  "mitigation": "Disable FEDERATED unless needed; validate hostnames; network ACLs",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 52,
                  "score": "3"
                },
                {
                  "id": "61a5e191-f245-46e6-aae3-c6d2ebd33230",
                  "title": "Malicious Triggers for Persistence",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Triggers added to run malicious code or leak data whenever rows change.",
                  "mitigation": "Audit triggers; least‑privilege on TRIGGER; metadata integrity checks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 53,
                  "score": "3"
                },
                {
                  "id": "96edb347-6f86-4b42-a354-edc612f0d4f2",
                  "title": "Unencrypted Data at Rest",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Data files and backups stored unencrypted, exposing data if disk stolen.",
                  "mitigation": "TDE (InnoDB encryption); disk/LUKS encryption; secure backup keys",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 54,
                  "score": "4"
                },
                {
                  "id": "89167fda-fda4-449e-823a-6b786ca067c4",
                  "title": "General Query Log Exposure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "General query log left enabled and world‑readable, leaking credentials and queries.",
                  "mitigation": "Disable in production; secure file permissions; rotate logs",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 55,
                  "score": "3"
                }
              ],
              "threatFrequency": {
                "tampering": 6,
                "repudiation": 4,
                "informationDisclosure": 9,
                "denialOfService": 3
              }
            }
          },
          {
            "position": {
              "x": 94,
              "y": 2
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "dad200fb-2719-4e3f-8393-ae521268ac87"
                },
                {
                  "group": "right",
                  "id": "cf82f76a-7144-40f3-aae2-151770ecaf91"
                },
                {
                  "group": "bottom",
                  "id": "07dff5f6-60b5-4188-997d-4d72f576fff8"
                },
                {
                  "group": "left",
                  "id": "8a0be86d-929e-4d96-bd70-de0ff03e1035"
                }
              ]
            },
            "id": "2552657f-eff4-4149-b850-e8f1c154216c",
            "data": {
              "type": "tm.Actor",
              "name": "User",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "4436f491-268f-4432-b6b9-4212595e99ba",
                  "title": "Eavesdropping",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Attacker captures clear-text traffic between client and server.",
                  "mitigation": "Enforce HTTPS (HSTS) • TLS 1.2+ • Disable plain HTTP",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": "4"
                },
                {
                  "id": "f79fe804-10a5-4b7e-a768-d787ebeff8a8",
                  "title": "Replay Attack",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Re-sending captured legitimate requests (e.g., payments).",
                  "mitigation": "Nonces/time-stamps Unique session tokens TLS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": "3"
                },
                {
                  "id": "8ed47be9-114e-4954-b59b-990d7a313c22",
                  "title": "SSL/TLS stripping or downgrade attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "The attacker downgrades an HTTPS connection to HTTP, allowing them to read the unencrypted data being exchanged. ",
                  "mitigation": "Redirect HTTP access attempts to HTTPS, among others",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": "4"
                },
                {
                  "id": "a19b7151-a6d2-48a2-8555-556dee04a65c",
                  "title": "Weak Encryption Standard",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Using weak or deprecated encryption standards such as SSL",
                  "mitigation": "Disable weak suites; TLS 1.2/1.3‑only; modern ciphers",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": "3"
                },
                {
                  "id": "f1a1b310-0ed7-4355-b276-fb4f580b6709",
                  "title": "Transparent Proxy Interception",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "he attacker sits between the user and server (e.g., via a rogue router or compromised ISP), acting as a silent proxy.",
                  "mitigation": "Certificate pinning; DNSSEC / DoH; TLS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": "3"
                },
                {
                  "id": "04eed093-d5b9-4169-a776-205ee5104750",
                  "title": "Session Hijacking (Cookie Theft / Sidejacking)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Compromising session cookies via network sniffing or injection to impersonate a user.",
                  "mitigation": "Secure & HttpOnly cookies; SameSite; TLS; re‑authentication; token rotation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": "4"
                },
                {
                  "id": "146b6e07-a187-4514-b7f1-c18b128b5aa6",
                  "title": "DNS Spoofing / Cache Poisoning",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Attacker poisons DNS responses to redirect user traffic to a malicious host.",
                  "mitigation": "DNSSEC; DoH/DoT; short TTLs; monitor for DNS anomalies",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": "4"
                },
                {
                  "id": "2a688e95-fd55-42d3-960c-01f0f4e3f873",
                  "title": "HTTP Request Smuggling",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Abusing inconsistencies between front‑end and back‑end HTTP parsing to smuggle requests.",
                  "mitigation": "Align proxy/server parsing; disable legacy transfer encodings; WAF rules",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": "3"
                },
                {
                  "id": "7263b758-8622-4e0f-b39c-a3a91b0ae168",
                  "title": "TLS Interception (with Forged Certificates)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Attacker presents a forged TLS certificate to the client while communicating with the server using the real certificate.",
                  "mitigation": "Certificate pinning; trusted public CAs; OCSP stapling",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": "4"
                }
              ],
              "threatFrequency": {
                "spoofing": 5,
                "repudiation": 4
              }
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 15,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Trust Boundary"
                  }
                }
              }
            ],
            "id": "8101ecb6-38ef-48a6-b5b5-9a3ac58c5817",
            "source": {
              "x": -38,
              "y": 622
            },
            "target": {
              "x": 302,
              "y": 582
            },
            "vertices": [
              {
                "x": 22,
                "y": 542
              },
              {
                "x": 60,
                "y": 490
              },
              {
                "x": 142,
                "y": 452
              }
            ]
          },
          {
            "position": {
              "x": 610,
              "y": 190
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Log System"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "38b97aaf-58a1-43b9-9e61-e36fbc482cc4"
                },
                {
                  "group": "right",
                  "id": "bdda7381-a4b5-4244-af8b-01e494e90e62"
                },
                {
                  "group": "bottom",
                  "id": "95ffbfa9-23b6-4b51-b6b1-0a05f9389c40"
                },
                {
                  "group": "left",
                  "id": "4f528ab5-5ec4-4ce7-9831-115d6dae3bad"
                }
              ]
            },
            "id": "27310524-54c2-49bc-961a-e38346b686ee",
            "data": {
              "type": "tm.Store",
              "name": "Log System",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "a0da2851-8f25-44a9-bc18-bdf8aa5e4eaf",
                  "title": "Log Injection / Forgery",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Attacker crafts inputs (headers, user-agents, etc.) to write fake or malicious entries that mislead analysts.",
                  "mitigation": "Sanitize all log fields \nUse structured logging (JSON) \nEscape control characters",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 73,
                  "score": "3"
                },
                {
                  "id": "c7597d4e-f170-4d55-9538-e51fa9826ff7",
                  "title": "Log Tampering After Write",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Insider or attacker with access modifies or deletes existing log files to cover tracks.",
                  "mitigation": "Write-once / append-only storage (WORM, immutability) \nCryptographic signing / hash-chaining \nRBAC on logs",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 74,
                  "score": "4"
                },
                {
                  "id": "47e8c471-86b9-4dd5-a4c7-cf841edfc06a",
                  "title": "Unencrypted Log Transport",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Logs shipped over the network (Syslog, Fluentd, Beats) without TLS can be sniffed or altered.",
                  "mitigation": "TLS/Mutual-TLS for log shippers \nVPN or private network links",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 75,
                  "score": "3"
                },
                {
                  "id": "645c7769-1088-4d46-9ef0-6cc800b5588c",
                  "title": "Sensitive Data in Logs (PII / Secrets)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Application logs inadvertently capture credentials, tokens, or personal data.",
                  "mitigation": "Log scrubbing / redaction middleware \nClassification & DLP scans \nDeveloper guidelines",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 76,
                  "score": "4"
                },
                {
                  "id": "4d63b733-21db-4dac-a88c-04818a32eec7",
                  "title": "Excessive Log Retention",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Logs kept indefinitely increase breach impact and cost.",
                  "mitigation": "Retention policy (e.g., 90 days) \nLifecycle rules / automatic deletion",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 78,
                  "score": "2"
                },
                {
                  "id": "d84b37f2-aae7-423c-a696-995be831effc",
                  "title": "Insufficient Log Retention",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "Logs rolled-over too quickly, hampering investigations / compliance.",
                  "mitigation": "Align retention with regulatory & forensic needs \nCapacity planning",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 79,
                  "score": "2"
                },
                {
                  "id": "3e6a5dc1-0d4d-4a9e-abc0-71c129fd5624",
                  "title": "Log Overflow / Disk Exhaustion",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Massive log volume fills disk, crashing services (DoS).",
                  "mitigation": "Log rotation & compression \nDedicated partition \nAlert on utilisation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 80,
                  "score": "3"
                },
                {
                  "id": "847ed117-8967-4bbd-8f72-dfc46286294f",
                  "title": "Unsecured Central Log Repository",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Central log directory or network share is world-readable or lacks encryption/ACLs, exposing all logs to any user on the network.",
                  "mitigation": "Tight filesystem / share permissions (read-only for SIEM, no public “others” access) \nEncrypt logs at rest \nNetwork segmentation / VPN for log collectors \nRegular audits of share permissions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 81,
                  "score": "4"
                },
                {
                  "id": "9b8c31c3-99dc-437b-9c9a-c6d3335d4f6d",
                  "title": "Missing Integrity Monitoring",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "No mechanism to verify logs weren’t altered in transit or at rest.",
                  "mitigation": "HMAC / digital signatures \nChain-of-custody audit trails \nSIEM alerts on hash mismatch",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 82,
                  "score": "3"
                },
                {
                  "id": "5b1cb5ff-9145-4cd3-9b13-45f85ac51c20",
                  "title": "Lack of Real-Time Alerting",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Critical events are logged but no alert is raised, delaying response.",
                  "mitigation": "Define alert rules / thresholds \nRegular rule testing",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 83,
                  "score": "3"
                }
              ],
              "threatFrequency": {
                "tampering": 3,
                "repudiation": 3,
                "informationDisclosure": 4,
                "denialOfService": 2
              }
            }
          }
        ]
      }
    ],
    "diagramTop": 1,
    "reviewer": "Rui Barbosa",
    "threatTop": 83
  }
}